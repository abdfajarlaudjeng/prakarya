<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pojok Baca Mapel Prakarya & Informatika</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans min-h-screen flex flex-col">
  <!-- Header -->
  <header class="bg-indigo-600 text-white p-4 shadow-md">
    <div class="max-w-6xl mx-auto">
      <h1 class="text-2xl font-bold">Dashboard Prakarya & Informatika</h1>
      <p class="text-sm">SMP NEGERI 10 BANAWA SELATAN</p>
    </div>
  </header>

  <!-- Main -->
  <main class="flex-1 p-4 sm:p-6">
    <div class="max-w-6xl mx-auto space-y-10">

      <!-- Materi -->
      <section id="materi">
        <h2 class="text-xl font-bold mb-3">üìò Materi Pelajaran</h2>
        <div id="materi-list" class="space-y-4 bg-white p-4 rounded-xl shadow"></div>
      </section>

      <!-- Tugas -->
      <section id="tugas">
        <h2 class="text-xl font-bold mb-3">üìù Tugas</h2>
        <div class="overflow-x-auto bg-white rounded-xl shadow">
          <table class="w-full text-sm text-left">
            <thead class="bg-indigo-500 text-white text-sm sm:text-base">
              <tr>
                <th class="p-3">Judul</th>
                <th class="p-3">Deadline</th>
                <th class="p-3">Status</th>
                <th class="p-3">Link</th>
              </tr>
            </thead>
            <tbody id="tugas-table" class="divide-y divide-gray-200"></tbody>
          </table>
        </div>
      </section>

      <!-- Nilai -->
      <section id="nilai">
        <h2 class="text-xl font-bold mb-3">üìä Nilai</h2>
        <div class="overflow-x-auto bg-white rounded-xl shadow">
          <table class="w-full text-sm text-left">
            <thead class="bg-indigo-500 text-white text-sm sm:text-base">
              <tr>
                <th class="p-3">Nama</th>
                <th class="p-3">Tugas</th>
                <th class="p-3">Kuis</th>
                <th class="p-3">Rata-rata</th>
              </tr>
            </thead>
            <tbody id="nilai-table" class="divide-y divide-gray-200"></tbody>
          </table>
        </div>
      </section>

    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-indigo-600 text-white text-center sm:text-left p-4 mt-8">
    <div class="max-w-6xl mx-auto">
      <p>¬© 2025 Dashboard Prakarya & Informatika</p>
    </div>
  </footer>

  <!-- Script -->
  <script>
    const url = "https://script.google.com/macros/s/AKfycbxAFRnPhnq_Q_FzyY7F_wBJJ6g-TuR6Un5eGQpRN7jVom3DmXI9E41jQyWS-ygxSLMo/exec";

    fetch(url)
      .then(res => res.json())
      .then(data => {
        // Materi (materi, sub tema, referensi)
        const materiList = document.getElementById("materi-list");
        data.materi.forEach(row => {
          let judul = row[0] || "";
          let subtema = row[1] || "";
          let referensi = row[2] || "";

          let referensiEl = "";
          if (referensi.startsWith("http")) {
            referensiEl = `<a href="${referensi}" target="_blank" 
                             class="bg-green-100 text-green-700 hover:bg-green-200 px-3 py-1 mt-1 inline-flex items-center gap-2 rounded-lg">
                             <svg xmlns="http://www.w3.org/2000/svg" fill="none" 
                                  viewBox="0 0 24 24" stroke-width="1.8" stroke="currentColor" 
                                  class="w-5 h-5">
                               <path stroke-linecap="round" stroke-linejoin="round" 
                                     d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 
                                        7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 
                                        9.963 7.178.07.207.07.431 0 .639C20.577 
                                        16.49 16.64 19.5 12 19.5c-4.638 
                                        0-8.573-3.007-9.963-7.178z"/>
                               <path stroke-linecap="round" stroke-linejoin="round" 
                                     d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                             </svg>
                             <span>Baca Buku</span>
                           </a>`;
          } else if (referensi) {
            referensiEl = `<p class="text-sm text-gray-600">Referensi: ${referensi}</p>`;
          }

          let div = document.createElement("div");
          div.className = "p-3 border rounded-lg hover:bg-gray-50";
          div.innerHTML = `<h3 class="font-semibold text-indigo-700">${judul}</h3>
                           <p class="text-gray-700 text-sm">Sub Tema: ${subtema}</p>
                           ${referensiEl}`;
          materiList.appendChild(div);
        });

        // Tugas
        const tugasTable = document.getElementById("tugas-table");
        data.tugas.forEach(row => {
          let deadline = row[1];
          if (deadline) {
            try {
              deadline = new Date(deadline).toLocaleDateString("id-ID", {
                year: "numeric",
                month: "long",
                day: "numeric"
              });
            } catch (e) {}
          }

          let status = row[2] ? row[2].toLowerCase() : "";
          let statusClass = "text-gray-700";
          if (status.includes("selesai")) statusClass = "text-green-600 font-semibold";
          else if (status.includes("proses")) statusClass = "text-yellow-600 font-semibold";
          else if (status.includes("belum")) statusClass = "text-red-600 font-semibold";

          let linkCell = "";
          if (row[3]) {
            linkCell = `<a href="${row[3]}" target="_blank" 
                          class="bg-indigo-100 text-indigo-700 hover:bg-indigo-200 px-3 py-1 rounded-lg flex items-center gap-2 justify-center">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" 
                               viewBox="0 0 24 24" stroke-width="1.8" stroke="currentColor" 
                               class="w-5 h-5">
                            <path stroke-linecap="round" stroke-linejoin="round" 
                                  d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 
                                     7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 
                                     9.963 7.178.07.207.07.431 0 .639C20.577 
                                     16.49 16.64 19.5 12 19.5c-4.638 
                                     0-8.573-3.007-9.963-7.178z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" 
                                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                          </svg>
                          <span>Kerjakan Tugas</span>
                        </a>`;
          } else {
            linkCell = `<span class="text-gray-400 flex justify-center">-</span>`;
          }

          let tr = document.createElement("tr");
          tr.classList.add("hover:bg-gray-50");
          tr.innerHTML = `<td class="p-3">${row[0]}</td>
                          <td class="p-3">${deadline}</td>
                          <td class="p-3 ${statusClass}">${row[2]}</td>
                          <td class="p-3 text-center">${linkCell}</td>`;
          tugasTable.appendChild(tr);
        });

        // Nilai
        const nilaiTable = document.getElementById("nilai-table");
        data.nilai.forEach(row => {
          let tr = document.createElement("tr");
          tr.classList.add("hover:bg-gray-50");
          tr.innerHTML = `<td class="p-3">${row[0]}</td>
                          <td class="p-3">${row[1]}</td>
                          <td class="p-3">${row[2]}</td>
                          <td class="p-3">${row[3]}</td>`;
          nilaiTable.appendChild(tr);
        });
      })
      .catch(err => console.error(err));
  </script>
</body>
</html>
